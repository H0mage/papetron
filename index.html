<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Electron App</title>
  </head>
  <body>
    <h1>Electron App</h1>
    <form id="myForm">
      <label for="directoryInput">Select a directory:</label>
      <input type="file" id="directoryInput" name="directory" directory webkitdirectory multiple>
      <ul id="directoryList"></ul>

      <label for="intervalSelect">Select time interval:</label>
      <select id="intervalSelect" name="interval">
        <option value="30000">30 seconds</option>
        <option value="60000">1 minute</option>
        <option value="300000">5 minutes</option>
        <option value="600000">10 minutes</option>
      </select>

      <label for="allowCollages">Allow Collages?</label>
      <input type="checkbox" id="allowCollages" name="collages">

      <label for="syncDisplays">Change all three displays at once?</label>
      <input type="checkbox" id="syncDisplays" name="sync">

      <button type="submit">Submit</button>
    </form>

    <script>
      const { ipcRenderer } = require('electron');

      const form = document.getElementById('myForm');

      let directoryList = [];

      document.getElementById("directoryInput").addEventListener(
      "change",
      (event) => {
        console.log(event)
        console.log(event.target.value)
        console.log(event.target.files)
        const files = event.target.files
        if (files.length > 0) {
          let list = document.getElementById("directoryList");
          const path = files[0].path;
          console.log(path);
          const splitPath = path.split("\\");
          console.log(splitPath)
          splitPath.pop();
          const finalPath = splitPath.join("\\")
          console.log(finalPath)
          directoryList.push(finalPath);
          let item = document.createElement("li");
          item.textContent = finalPath
          list.appendChild(item)
        }
        // let output = document.getElementById("listing");
        // for (const file of event.target.files) {
        //   let item = document.createElement("li");
        //   item.textContent = file.webkitRelativePath;
        //   output.appendChild(item);
        // }
      },
      false
    );

      form.addEventListener('submit', (event) => {
        event.preventDefault();
        console.log(directoryList)
        const timeInterval = document.getElementById('intervalSelect').value;
        console.log(timeInterval);
        const collages = document.getElementById('allowCollages').value;
        console.log(collages);
        const displays = document.getElementById('syncDisplays').value;
        console.log(displays);
        const formValues = {
          directoryList,
          timeInterval,
          isCollage: collages === 'on' ? true : false,
          synchronizedDisplays: collages === 'on' ? true : false,
        }
        ipcRenderer.send('form:submit', formValues);
      });
    </script>
  </body>
</html>
